#!/bin/sh
################################################################################
# Generated by mkconfigure
# Thu Jun  1 20:33:40 EEST 2017
#
# mkconfigure -name formake -version 0.9.7 -f
#
# Important variables to use:
#   PACKAGE_NAME     - package (project) name
#   PACKAGE_VERSION  - package version
#   CONF             - name of the build config file
#   SRCROOT          - package source root directory (package top dir)

################################################################################
# BASE CONFIGURATION
PACKAGE_NAME="formake"
PACKAGE_VERSION="0.9.8"
CONF="build.conf"
MK_CONF="mk.conf"
DISTCLEAN_FILES="$CONF $MK_CONF configure.log"

################################################################################
# PACKAGE PATHES
SRCROOT=`dirname $0`
PATH=`pwd`/mk:$SRCROOT/mk:$PATH

################################################################################
# PACKAGE CONSISTENCY
#
# Here we check scripts that are used by this script
excom relpath || exit 1


################################################################################
# IMPORTANT VARIABLES
#
SRCROOT=`dirname $0 | xargs relpath ./`
ABS_SRCROOT=`pwd`/$SRCROOT

################################################################################
# OPTIONS
while test $# -gt 0; do
  param=`echo -n "$1" | sed 's/^--*/-/'`
  case $param in
    -h|-help)
      op_help=1
      ;;
    -prefix=*)
      PREFIX=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -exec-prefix=*)
      EXEC_PREFIX=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -bindir=*)
      BINDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -sbindir=*)
      SBINDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -libexecdir=*)
      LIBEXECDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -libdir=*)
      LIBDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -incdir=*)
      INCDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -etcdir=*)
      ETCDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -vardir=*)
      VARDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -sharedir=*)
      SHAREDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -mandir=*)
      MANDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    -docdir=*)
      DOCDIR=`echo -n "$param" | sed 's/^[^=]*=//'`
      ;;
    *)
      echo "$script_name: invalid option: $1"
      exit 1
      ;;
  esac
  shift
done

if test x$op_help = x1; then
  cat <<EOF
Usage: configure [options]
  --prefix=PREFIX         path to install architecture-independent files [/usr/local]
  --exec-prefix=EPREFIX   path to install architecture-dependent files [PREFIX]
  --bindir=DIR            bin path [EPREFIX/bin]
  --sbindir=DIR           sbin path [EPREFIX/sbin]
  --libexecdir=DIR        libexec path [EPREFIX/libexec]
  --libdir=DIR            lib path [EPREFIX/lib]
  --incdir=DIR            include path [PREFIX/include]
  --etcdir=DIR            etc path [PREFIX/etc]
  --vardir=DIR            var path [PREFIX/var]
  --sharedir=DIR          share path [PREFIX/share]
  --mandir=DIR            man path [SHAREDIR/man]
  --docdir=DIR            doc path [SHAREDIR/doc]
EOF
  exit 0
fi

################################################################################
# VPATH
VPATH_ON=
test ! -f `basename $0` && VPATH_ON=1

################################################################################
# INIT BUILD ROOT
if test x$VPATH_ON = x1; then
  if test -f $SRCROOT/mk; then
    cp -Rf $SRCROOT/mk ./
    rm -f mk/*.conf
  fi
fi


################################################################################
# STANDARD DIRECTORIES
#
# Set up standard installation directories

test -n "$PREFIX"      || PREFIX=/usr/local
test -n "$EXEC_PREFIX" || EXEC_PREFIX=$PREFIX
test -n "$BINDIR"      || BINDIR=$EXEC_PREFIX/bin
test -n "$SBINDIR"     || SBINDIR=$EXEC_PREFIX/sbin
test -n "$LIBEXECDIR"  || LIBEXECDIR=$EXEC_PREFIX/libexec
test -n "$ETCDIR"      || ETCDIR=$PREFIX/etc
test -n "$VARDIR"      || VARDIR=$PREFIX/etc
test -n "$LIBDIR"      || LIBDIR=$EXEC_PREFIX/lib
test -n "$INCDIR"      || INCDIR=$PREFIX/include
test -n "$SHAREDIR"    || SHAREDIR=$PREFIX/share
test -n "$MANDIR"      || MANDIR=$SHAREDIR/man
test -n "$DOCDIR"      || DOCDIR=$SHAREDIR/doc

DOCDIR=$DOCDIR/$PACKAGE_NAME
DATADIR=$SHAREDIR/$PACKAGE_NAME


################################################################################
# CREATE BUILD AND MK CONFIG FILES
cat <<EOF >$CONF
PACKAGE_NAME="$PACKAGE_NAME"
PACKAGE_VERSION="$PACKAGE_VERSION"
PREFIX="$PREFIX"
EXEC_PREFIX="$EXEC_PREFIX"
BINDIR="$BINDIR"
SBINDIR="$SBINDIR"
LIBEXECDIR="$LIBEXECDIR"
LIBDIR="$LIBDIR"
INCDIR="$INCDIR"
ETCDIR="$ETCDIR"
VARDIR="$VARDIR"
SHAREDIR="$SHAREDIR"
MANDIR="$MANDIR"
DOCDIR="$DOCDIR"
DATADIR="$DATADIR"
SRCROOT="$SRCROOT"
ABS_SRCROOT="$ABS_SRCROOT"
EOF

cat $CONF > mk/$MK_CONF


################################################################################
## CHECK THAT REQUIRED PROGRAMS ARE AVAILABLE
##
## Run 'excom -help' to get a full list of options

## Example. Find programs: ar tar bzip2. Exit if any one not found.
# excom ar tar bzip2 || exit 1

excom install  || exit 1


$SRCROOT/mkmf

################################################################################
# FINISH
echo "configuring done."

